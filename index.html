<script>
  (function(){
    const apiUrl = 'https://script.google.com/macros/s/AKfycbxHfvy2MROrt3oujNzAmbdR5VafRFGNTmsIwCD7NvwGuNRlofSEdKhnYjuSNU5j4Xkmyw/exec';

    document.getElementById('buscar').addEventListener('click', () => {
      const rol = document.getElementById('rol').value.trim();
      if (!rol) return alert('Ingresa tu ROL');

      fetch(`${apiUrl}?rol=${encodeURIComponent(rol)}`)
        .then(r => r.json())
        .then(alumno => {
          if (alumno.error) throw new Error(alumno.error);

          document.getElementById('nombre-estudiante').textContent = alumno['Nombre'] || '';
          const map = {
            'PG1': 'pg1',
            'PG2': 'pg2',
            'PG3': 'pg3',
            'PG4': 'pg4',
            'Presentaciones y Trabajos': 'promedio-presentacion-trabajos',
            'Tarea VSM': 'tarea-vsm',
            'Tarea 5S': 'tarea-5s',
            'Tareas': 'promedio-tareas',
            'Proyecto': 'proyecto-final',
            'Puntos extra': 'puntos-extra-vr',
            'Jenga Lean': 'jenga-lean',
            'Reporte A3': 'reporte-a3',
            'Nota Final': 'nota-final'
          };
          Object.entries(map).forEach(([col,id]) => {
            document.getElementById(id).value = alumno[col] || '';
          });
          document.getElementById('resultados').style.display = 'block';
        })
        .catch(e => alert(e.message));
    });
  })();
</script>

